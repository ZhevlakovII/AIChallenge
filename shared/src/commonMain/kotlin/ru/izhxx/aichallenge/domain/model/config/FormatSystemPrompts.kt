package ru.izhxx.aichallenge.domain.model.config

/**
 * Содержит системные промпты для указания формата ответа LLM
 */
object FormatSystemPrompts {
    /**
     * Системный промпт для JSON формата ответа
     */
    val JSON_FORMAT_PROMPT = """
    Отвечай ТОЛЬКО валидным JSON объектом. Ничего кроме JSON. Без пояснений до или после JSON.
    Строго соблюдай структуру:
    {
      "summary": "краткая суть (1-2 предложения)",
      "explanation": "подробное объяснение с поддержкой инлайн markdown-элементов (жирный, курсив, ссылки, код)",
      "code": "код если требуется, или null",
      "references": ["источник1", "источник2"]
    }
    
    В поле explanation ты можешь использовать следующие инлайн markdown-элементы:
    - **жирный текст** - обрамляй двумя звездочками с каждой стороны: **текст**
    - _курсивный текст_ - обрамляй одним подчеркиванием с каждой стороны: _текст_
    - [ссылки](https://example.com) - используй формат: [текст ссылки](URL)
    - `инлайн-код` - обрамляй одинарными обратными кавычками: `код`
    
    НЕ используй в explanation кодовые блоки и другие блочные элементы markdown!
    Твой ответ должен начинаться с '{' и заканчиваться '}'.
    """.trimIndent()

    /**
     * Системный промпт для Markdown формата ответа
     */
    val MARKDOWN_FORMAT_PROMPT = """
    Отвечай с использованием Markdown разметки. Используй заголовки, списки, 
    выделение жирным и курсивом, кодовые блоки и другие элементы разметки 
    для форматирования твоего ответа.
    
    Пример хорошо отформатированного ответа:
    
    # Заголовок ответа
    
    Вот **основная идея** в краткой форме.
    
    ## Детали
    
    Здесь более _подробное_ объяснение концепции:
    
    1. Первый пункт
    2. Второй пункт
    3. Третий пункт
    
    Вот пример кода:
    
    ```kotlin
    fun example() {
        println("Это пример кода")
    }
    ```
    """.trimIndent()

    /**
     * Системный промпт для формата без форматирования
     * Позволяет получить прямой ответ от модели без структурирования
     */
    val PLAIN_FORMAT_PROMPT = """
    Отвечай обычным текстом без специального форматирования. 
    Просто дай прямой ответ на вопрос пользователя.
    """.trimIndent()

    /**
     * Получить промпт для указанного формата ответа
     */
    fun getFormatPrompt(format: ResponseFormat): String {
        return when(format) {
            ResponseFormat.JSON -> JSON_FORMAT_PROMPT
            ResponseFormat.MARKDOWN -> MARKDOWN_FORMAT_PROMPT
            ResponseFormat.PLAIN -> PLAIN_FORMAT_PROMPT
        }
    }
}
